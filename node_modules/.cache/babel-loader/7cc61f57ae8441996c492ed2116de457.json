{"ast":null,"code":"import _slicedToArray from\"/Users/andresgonzalez/Documents/mixtis/Parcial2web/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from\"react\";import{FormattedMessage}from\"react-intl\";import*as d3 from\"d3\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function TitleLenguage(){var lenguage=navigator.language||navigator.userLanguage;if(lenguage.startsWith(\"es\")){return\"Uso de poder (KwH) - Hoy\";}else if(lenguage.startsWith(\"en\")){return\"Power usage (KwH) - Today\";}else{return\"Power usage (KwH) - Today\";}}function Charts(props){var Charts=useRef(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),rooms=_useState2[0],setRooms=_useState2[1];useEffect(function(){setRooms(props.rooms);var iWidth=300;var iHeight=300;var radius=100;// Define size and pos of svg\nvar svg=d3.select(Charts.current).attr(\"width\",iWidth).attr(\"height\",iHeight).append(\"g\").attr(\"transform\",\"translate(\".concat(iWidth/2,\", \").concat(iHeight/2,\")\"));svg.append(\"text\").attr(\"x\",0).attr(\"y\",-radius-20).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"23px\").text(TitleLenguage());var chartData=d3.pie().value(function(d){return d.powerUsage.value;})(rooms);// Define arcs for graph and label\nvar arc=d3.arc().innerRadius(0).outerRadius(radius);var colors=d3.scaleOrdinal().range(d3.schemeDark2);// Add tooltip\nvar tooldiv=d3.select(\"#chartD3\").append(\"div\").style(\"visibility\",\"hidden\").style(\"position\",\"absolute\").style(\"background-color\",\"Cyan\");svg.append(\"g\").selectAll(\"path\").data(chartData).join(\"path\").attr(\"d\",arc).attr(\"fill\",function(d,i){return colors(i);}).attr(\"stroke\",\"white\").on(\"mousemove\",function(e){tooldiv.style(\"top\",e.pageY-30+\"px\").style(\"left\",e.pageX-50+\"px\");}).on(\"mouseover\",function(e,d){tooldiv.style(\"visibility\",\"visible\").text(\"\".concat(d.data.name,\": \").concat(d.data.powerUsage.value,\" \").concat(d.data.powerUsage.unit));}).on(\"mouseout\",function(){tooldiv.style(\"visibility\",\"hidden\");});},[props.rooms,rooms]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"roomTitle\",style:{textAlign:\"left\",marginLeft:\"2rem\"},children:/*#__PURE__*/_jsx(FormattedMessage,{id:\"charts\"})}),/*#__PURE__*/_jsx(\"div\",{id:\"chart\",children:/*#__PURE__*/_jsx(\"svg\",{ref:Charts})})]});}export default Charts;","map":{"version":3,"sources":["/Users/andresgonzalez/Documents/mixtis/Parcial2web/src/Components/Charts.js"],"names":["React","useEffect","useRef","useState","FormattedMessage","d3","TitleLenguage","lenguage","navigator","language","userLanguage","startsWith","Charts","props","rooms","setRooms","iWidth","iHeight","radius","svg","select","current","attr","append","style","text","chartData","pie","value","d","powerUsage","arc","innerRadius","outerRadius","colors","scaleOrdinal","range","schemeDark2","tooldiv","selectAll","data","join","i","on","e","pageY","pageX","name","unit","textAlign","marginLeft"],"mappings":"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","sourcesContent":["\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport * as d3 from \"d3\";\n\nfunction TitleLenguage() {\n  let lenguage = navigator.language || navigator.userLanguage;\n  if (lenguage.startsWith(\"es\")) {\n    return \"Uso de poder (KwH) - Hoy\";\n  } else if (lenguage.startsWith(\"en\")) {\n    return \"Power usage (KwH) - Today\";\n  } else {\n    return \"Power usage (KwH) - Today\";\n  }\n}\n\nfunction Charts(props) {\n  const Charts = useRef(null);\n\n  const [rooms, setRooms] = useState([]);\n\n  useEffect(() => {\n    setRooms(props.rooms);\n    const iWidth = 300;\n    const iHeight = 300;\n    const radius = 100;\n\n    // Define size and pos of svg\n    const svg = d3\n      .select(Charts.current)\n      .attr(\"width\", iWidth)\n      .attr(\"height\", iHeight)\n      .append(\"g\")\n      .attr(\"transform\", `translate(${iWidth / 2}, ${iHeight / 2})`);\n\n    svg\n      .append(\"text\")\n      .attr(\"x\", 0)\n      .attr(\"y\", -radius - 20)\n      .attr(\"text-anchor\", \"middle\")\n      .style(\"font-size\", \"23px\")\n      .text(TitleLenguage());\n\n    const chartData = d3.pie().value((d) => d.powerUsage.value)(rooms);\n\n    // Define arcs for graph and label\n\n    const arc = d3.arc().innerRadius(0).outerRadius(radius);\n\n    const colors = d3.scaleOrdinal().range(d3.schemeDark2);\n\n    // Add tooltip\n    const tooldiv = d3\n      .select(\"#chartD3\")\n      .append(\"div\")\n      .style(\"visibility\", \"hidden\")\n      .style(\"position\", \"absolute\")\n      .style(\"background-color\", \"Cyan\");\n\n    svg\n      .append(\"g\")\n      .selectAll(\"path\")\n      .data(chartData)\n      .join(\"path\")\n      .attr(\"d\", arc)\n      .attr(\"fill\", (d, i) => colors(i))\n      .attr(\"stroke\", \"white\")\n      .on(\"mousemove\", function (e) {\n        tooldiv\n          .style(\"top\", e.pageY - 30 + \"px\")\n          .style(\"left\", e.pageX - 50 + \"px\");\n      })\n      .on(\"mouseover\", (e, d) => {\n        tooldiv\n          .style(\"visibility\", \"visible\")\n          .text(\n            `${d.data.name}: ${d.data.powerUsage.value} ${d.data.powerUsage.unit}`\n          );\n      })\n      .on(\"mouseout\", () => {\n        tooldiv.style(\"visibility\", \"hidden\");\n      });\n  }, [props.rooms, rooms]);\n\n  return (\n    <div>\n      <h2\n        className=\"roomTitle\"\n        style={{ textAlign: \"left\", marginLeft: \"2rem\" }}\n      >\n        <FormattedMessage id=\"charts\" />\n      </h2>\n      <div id=\"chart\">\n        <svg ref={Charts}></svg>\n      </div>\n    </div>\n  );\n}\n\nexport default Charts;"]},"metadata":{},"sourceType":"module"}